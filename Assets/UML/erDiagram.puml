@startuml

skinparam classAttributeIconSize 0

' --- Entities ---
entity "ARPrefabRegistry" as ARPrefabRegistry
entity "DefaultPrefabRegistry" as DefaultPrefabRegistry

entity "ARObjectFactory" as ARObjectFactory {
  * Create(name: string, parent: Transform)
}

entity "IGestureHandler" as IGestureHandler {
  * OnDragStart(startPos: Vector2)
  * OnDrag(delta: Vector2)
  * OnDragEnd(endPos: Vector2)
  * OnPinchStart(initialDistance: float)
  * OnPinch(scaleFactor: float)
  * OnPinchEnd()
}

entity "PinchToScaleHandler" as PinchToScaleHandler {
  - initialScale: Vector3
  * OnPinchStart(initialDistance: float)
  * OnPinch(scaleFactor: float)
  * OnPinchEnd()
}

entity "SwipeToRotateHandler" as SwipeToRotateHandler {
  - targetRotation: Quaternion
  * rotationSpeed: float
  * OnDragStart(startPos: Vector2)
  * OnDrag(delta: Vector2)
  * OnDragEnd(endPos: Vector2)
}

entity "GestureInputManager" as GestureInputManager {
  * Instance: GestureInputManager
  - interactableLayerMask: LayerMask
  - mainCamera: Camera
  - activeHandlers: Dictionary<int, IGestureHandler>
  - pinchActive: bool
  - pinchHandler: IGestureHandler
  - initialPinchDistance: float
  * Update()
  - HandleSingleTouch(touch: Touch)
  - HandlePinch(t1: Touch, t2: Touch)
  - EndPinch()
}

entity "ImageTrackingController" as ImageTrackingController {
  * OnTrackedImageDetected(name: string)
}

entity "ImageTrackingObjectManager" as ImageTrackingObjectManager {
  - trackedImageManager: ARTrackedImageManager
  * OnTrackedImagesChanged(args: ARTrackedImagesChangedEventArgs)
}

' --- Supporting types ---
entity "GameObject"
entity "ARTrackedImageManager"
entity "ARTrackedImagesChangedEventArgs"
entity "Touch"
entity "LayerMask"
entity "Camera"
entity "Transform"
entity "Quaternion"
entity "Vector2"
entity "Vector3"

' --- Relationships ---
ARObjectFactory }o-- GameObject : creates
ImageTrackingObjectManager }o-- ARTrackedImageManager : uses
ImageTrackingObjectManager --> ARObjectFactory : invokes
ImageTrackingController --> ImageTrackingObjectManager : coordinates

GestureInputManager --> Touch            : processes
GestureInputManager --> LayerMask        : filters by
GestureInputManager --> Camera           : raycasts via
GestureInputManager --> GameObject       : hitâ†’handler
GestureInputManager ..> IGestureHandler  : dispatches
PinchToScaleHandler --|> IGestureHandler
SwipeToRotateHandler --|> IGestureHandler

@enduml
